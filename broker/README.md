# DataBroker

Связующий элемент для всех частей системы, проксирует сообщения от _ClientAPI_ к базе данных. 
Следит за актуализацией данных, посредством запуска _Fetchers_

### Настройка

    docker-compose build

### Инициализировать базу данных:

В отдельной вкладке терминала запустить:

    docker-compose up db
    
Дождаться запуска базы, перейти в другую вкладку и запустить:

    docker-compose run --rm broker-app bin/rails db:setup

После этого можно вернуться во вкладку с запущенной бд и остановить процесс _(Ctrl+C)_

### Запуск приложения

    docker-compose up
    
После этого на порту 3123 станет доступен брокер

# API

Доступно REST-Api для управления пользователями администратором. Авторизация осуществляется, посредством передачи токена в заголовке X-Auth-Token.
Без авторизации доступно только создание нового пользователя, для этого надо передать емейл, например так:

    curl 'http://localhost:3123/users' --data "user[email]=test@email.com"

Пользователю с ролью `admin` доступны для управления все остальные пользователи. С прочими ролями - только собственный пользователь.